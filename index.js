var songlist=[
  {
      "name": "《沃玛的生活》第三期ED",
      "artist": "warma养鸽场",
      "hash": "74e22fed14be5f5164b8273859d1a15f",
      "album_id": ""
  },
  {
      "name": "【翻唱】朝汐",
      "artist": "warma",
      "hash": "6f83cf8ef8dc206c239880d10711d4fc",
      "album_id": "68070847"
  },
  {
      "name": "【FREE】lucky",
      "artist": "FuGa pang",
      "hash": "c6620b7feb698d90a853fa64bdd6e279",
      "album_id": "38926342"
  },
  {
      "name": "爱的魔法",
      "artist": "晚巧",
      "hash": "7a5ec15f8aba6a2b174f7224b15956e0",
      "album_id": "45348716"
  },
  {
      "name": "白色",
      "artist": "灰澈",
      "hash": "1b47eb264b8c42d5dcbf57e9caf7f424",
      "album_id": "8540105"
  },
  {
      "name": "宝贝别哭",
      "artist": "艾索",
      "hash": "ed5951fa3912735fe8808620674b091f",
      "album_id": "28378420"
  },
  {
      "name": "采茶纪",
      "artist": "Warma",
      "hash": "80687839017981a6c2883f6025d4c4f6",
      "album_id": "15863348"
  },
  {
      "name": "虫儿飞 (温柔版)",
      "artist": "晚巧",
      "hash": "ce41d87fddf9c81094ec490eed07869a",
      "album_id": "68387559"
  },
  {
      "name": "春节序曲",
      "artist": "中国国家交响乐团",
      "hash": "ee86ed841d2b1e1434427a8aff4192f2",
      "album_id": "891025"
  },
  {
      "name": "春之行",
      "artist": "灰澈",
      "hash": "b3b44c7082ff9094cc19f2753d3b6701",
      "album_id": "8540055"
  },
  {
      "name": "泛泛人类不会祈祷 人声本家",
      "artist": "warma",
      "hash": "3601dd7422a36b812ab6c042780c2721",
      "album_id": "79338473"
  },
  {
      "name": "风摇盛夏",
      "artist": "逆时针向",
      "hash": "e16e5e0b6520b553f6d5412a390760ad",
      "album_id": "50115709"
  },
  {
      "name": "勾指起誓",
      "artist": "Warma",
      "hash": "56a5ed212cdf52d20e2364d533dc73b7",
      "album_id": "19195824"
  },
  {
      "name": "嘿咻狂想曲",
      "artist": "艾索",
      "hash": "d18cfe4eb5e3923591eacd4bf7cf5121",
      "album_id": "28378420"
  },
  {
      "name": "皇家萌卫",
      "artist": "灵空GTech",
      "hash": "79d5b56879f109065ca2948d3736aff5",
      "album_id": "18694318"
  },
  {
      "name": "寂静之空",
      "artist": "傅许",
      "hash": "b40a282b46e21ffd044ca82460a8d7a2",
      "album_id": "4080619"
  },
  {
      "name": "静かにHold Me Tight",
      "artist": "中村さんそ、KMNZ LIZ、nyankobrq",
      "hash": "cf1c89e7d415ab2a904bdfd796361667",
      "album_id": "36658844"
  },
  {
      "name": "来自天空的呼唤",
      "artist": "Warma",
      "hash": "a2fc6fb4de0ca3cbc05af03f3ea4a49d",
      "album_id": "76300692"
  },
  {
      "name": "恋爱サーキュレーション",
      "artist": "花澤香菜",
      "hash": "fa2ce6a44e64e3912e98c6ebc271b0da",
      "album_id": "18907263"
  },
  {
      "name": "馬鹿ふたり",
      "artist": "折戸伸治",
      "hash": "701d8c7bc595c9b28badcfc83d59cc45",
      "album_id": "558802"
  },
  {
      "name": "芒种",
      "artist": "音阙诗听、赵方婧",
      "hash": "3136cc973f70dcff711f82bf43ac094a",
      "album_id": "36895840"
  },
  {
      "name": "猫的舞步",
      "artist": "Candy_Wind",
      "hash": "e02bb53e2146fe77835531ed5dc72cf0",
      "album_id": "19615128"
  },
  {
      "name": "猫祭り",
      "artist": "イロドリミドリ",
      "hash": "25819f30b057bc707804be934cdb8107",
      "album_id": "15533653"
  },
  {
      "name": "每一句都很甜",
      "artist": "薄荷er",
      "hash": "4b7b7e2bcf6869a2c8e3d42028021ef1",
      "album_id": "14065001"
  },
  {
      "name": "妙奇星球 (温柔版)",
      "artist": "艾索",
      "hash": "428c8deea39f008906f14dfd2ce0d494",
      "album_id": "41934682"
  },
  {
      "name": "木鲸 (纯音乐)",
      "artist": "灰澈",
      "hash": "f05297042a522b5bd5879fad392c9a48",
      "album_id": "8540064"
  },
  {
      "name": "你从未离去",
      "artist": "白挺",
      "hash": "1a0e2b29d2de2e159295192860797e40",
      "album_id": "648995"
  },
  {
      "name": "平凡之路",
      "artist": "朴树",
      "hash": "8d55c7e3ecc324c0ff490d1fb59404ac",
      "album_id": "2944963"
  },
  {
      "name": "千本桜",
      "artist": "黒うさP、初音ミク",
      "hash": "c5685a883b7555b2c01ca30010413fa2",
      "album_id": "29441107"
  },
  {
      "name": "让风告诉你",
      "artist": "花玲、喵酱油、宴宁、Kinsen",
      "hash": "a061d68d9ce699089c76151a9a551414",
      "album_id": "41668184"
  },
  {
      "name": "森林",
      "artist": "灰澈",
      "hash": "45399ccdb146482feeb81ec9a03120c3",
      "album_id": "8540101"
  },
  {
      "name": "时光森林",
      "artist": "李昕融、叶嘉",
      "hash": "fe313304f7ff251a09551c1ed8caa8b0",
      "album_id": "57968216"
  },
  {
      "name": "瞬间的永恒 (钢琴曲)",
      "artist": "赵海洋",
      "hash": "281397f2aa3dedae1b7550052058699c",
      "album_id": "2520810"
  },
  {
      "name": "她追逐着月光的尽头",
      "artist": "Warma",
      "hash": "b33afd480d573729ac1bbe0a67cbd07d",
      "album_id": "50035997"
  },
  {
      "name": "糖",
      "artist": "李昕融",
      "hash": "8e79e915aa7ff6ce50b09f6c7c522fd2",
      "album_id": "51603850"
  },
  {
      "name": "晚安喵",
      "artist": "艾索",
      "hash": "aabae74a32dd9158093fe5f5529c8cb5",
      "album_id": "928787"
  },
  {
      "name": "晚安喵",
      "artist": "山新",
      "hash": "817eb58e3a52233ae8348eccb42efd4c",
      "album_id": "28378420"
  },
  {
      "name": "温软宇宙",
      "artist": "Crazy Bucket 陈楒潼、浮云心丶、Warma",
      "hash": "5059ce3326f1e8a9202f9451cd4c46f9",
      "album_id": "35880306"
  },
  {
      "name": "我家里有蜘蛛!!!",
      "artist": "Warma",
      "hash": "8d454122c5f9319de4813b3994ea89e3",
      "album_id": "26546012"
  },
  {
      "name": "午后",
      "artist": "灰澈",
      "hash": "337a4dd5ea4a86e606c9bb8818086902",
      "album_id": "8540084"
  },
  {
      "name": "夏日美梦 (纯音乐)",
      "artist": "BlackDD",
      "hash": "644a6080938ed123c21cb5f8c9e0b407",
      "album_id": "36735200"
  },
  {
      "name": "夏天幻游日记",
      "artist": "Warma",
      "hash": "8bc1c547f9b06417c70a6ac5beacd1e3",
      "album_id": "65892685"
  },
  {
      "name": "夏野与暗恋",
      "artist": "闫东炜",
      "hash": "1cee2ec1e4353aa687898d247d60156e",
      "album_id": "8538502"
  },
  {
      "name": "想对你说",
      "artist": "赵希予",
      "hash": "a0d119f00a8e2f0f35026bd65ab47640",
      "album_id": "62197357"
  },
  {
      "name": "星茶会",
      "artist": "灰澈",
      "hash": "291bc4a62f61d996ad3a5a31bdab9985",
      "album_id": "8540110"
  },
  {
      "name": "星河",
      "artist": "海、枫总",
      "hash": "4c2f09ebebd4d61ff6916c35961c7a79",
      "album_id": "41892811"
  },
  {
      "name": "嘘",
      "artist": "艾索",
      "hash": "82b47a4a4ffd8658f164d73dcbf4791a",
      "album_id": "28378420"
  },
  {
      "name": "嘘 (流行版)",
      "artist": "艾索",
      "hash": "338cdac548b9cf7a49e772a8650ec4f9",
      "album_id": "28378420"
  },
  {
      "name": "幼女幻奏",
      "artist": "Sing, R. Sing!",
      "hash": "1475dedf2c9800dcb0ef5fb3abf88444",
      "album_id": "642845"
  },
  {
      "name": "遇见 (钢琴版)",
      "artist": "文武贝",
      "hash": "08313c5fd933116d6f8bb3b3f123e71c",
      "album_id": "8568845"
  },
  {
      "name": "在你的身边",
      "artist": "盛哲",
      "hash": "d06f97d2b923f89c755e2cfceccaa69c",
      "album_id": "4128050"
  },
  {
      "name": "沢の河城工務店",
      "artist": "Foxtail-Grass Studio",
      "hash": "7de0704edf6167f7a00dd92d53db56c1",
      "album_id": "579443"
  },
  {
      "name": "终会与你同行",
      "artist": "白挺",
      "hash": "4957d156935f3c3c8c184945bda32dd9",
      "album_id": "555705"
  },
  {
      "name": "逐渐加快",
      "artist": "Warma",
      "hash": "0e6e8cba9ef1dd7dd79135f12459e3e1",
      "album_id": ""
  },
  {
      "name": "A Little Story",
      "artist": "Valentin",
      "hash": "d0b5c18cf928671868a040d116997980",
      "album_id": "565498"
  },
  {
      "name": "At The Edge",
      "artist": "千坂",
      "hash": "a3efe5899d9981b852f4cd96c3a253f1",
      "album_id": "15804450"
  },
  {
      "name": "Bloom of Youth",
      "artist": "清水準一",
      "hash": "630cb49e85e77472a40ab6f9ee76ac72",
      "album_id": "558811"
  },
  {
      "name": "color-X",
      "artist": "徐梦圆",
      "hash": "f49d327b02027f73a83740ef09c22f0d",
      "album_id": "14465352"
  },
  {
      "name": "Empty Love",
      "artist": "Lulleaux、Kid Princess",
      "hash": "ee1b8c074962377de20e0bdb2d50b9e9",
      "album_id": "36762089"
  },
  {
      "name": "Escape",
      "artist": "Dripice",
      "hash": "168f8e87cd800155d59b0d96783edd08",
      "album_id": "1886257"
  },
  {
      "name": "Hello",
      "artist": "OMFG",
      "hash": "e15af1df4f59a0627089c97ffa43b3fc",
      "album_id": "645752"
  },
  {
      "name": "His Theme",
      "artist": "Toby Fox",
      "hash": "cf4782383324f712903abef91e9cedb6",
      "album_id": "1983482"
  },
  {
      "name": "I really ∞",
      "artist": "Warma",
      "hash": "01b8c5338279d95e6ad1ca6a480b307b",
      "album_id": "30129032"
  },
  {
      "name": "Love is gone (Justin Dai & Marvin Bootleg) (remix：Marvin)",
      "artist": "SLANDER、Dylan Matthew、Marvin",
      "hash": "af6ba1ced9a7ae2c0306c5844425c735",
      "album_id": "39744265"
  },
  {
      "name": "Mesmerize",
      "artist": "Tobu",
      "hash": "5b201c0c0cdced697e7aa414a9483a5e",
      "album_id": "891102"
  },
  {
      "name": "Nyan Cat",
      "artist": "桃音モモ",
      "hash": "dab6f80e693daea02546a4c0ee6e39a6",
      "album_id": "939889"
  },
  {
      "name": "Outerspace",
      "artist": "BEAUZ",
      "hash": "f9f864020587bfb72b63f2e022981384",
      "album_id": "39270553"
  },
  {
      "name": "Racing Into The Night (Remix)",
      "artist": "Errol Sneer Jr",
      "hash": "27c43374b2a139c16f81449dafd50c97",
      "album_id": "50988166"
  },
  {
    "type":"netease",
    "id":"20110049",
    "name":"River Flows In You",
    "artist":"Martin Ermen",
    album:"Kuschelklassik Piano Dreams, Vol. 2"
  },
  {
      "name": "Skyland",
      "artist": "Mich",
      "hash": "cbd048d584a40ce5912fad0d2754f8a6",
      "album_id": "1051921"
  },
  {
      "name": "Summer Dream",
      "artist": "Kirara Magic、Chevy",
      "hash": "e00c81212ac20ada0c9bee4df287b6d3",
      "album_id": "45902157"
  },
  {
      "name": "Sunburst",
      "artist": "Tobu、Itro",
      "hash": "f2ede04e3555d8d8fc3e79fa8f9584bc",
      "album_id": "572468"
  },
  {
      "name": "The Right Path",
      "artist": "Thomas Greenberg",
      "hash": "c97ddeb13223bea42952d1492953e76b",
      "album_id": "594466"
  },
  {
      "name": "The Rose (尤克里里弹唱)",
      "artist": "Warma",
      "hash": "a9c44dd42b484e8389c58e23bcfd5234",
      "album_id": "40179832"
  },
  {
      "name": "The Truth That You Leave",
      "artist": "Pianoboy高至豪",
      "hash": "d09301f64461dfddabe201aa70820680",
      "album_id": "33328496"
  },
  {
      "name": "Ticking",
      "artist": "Tin",
      "hash": "a8e92aca58ee3607e693b2d020933a2f",
      "album_id": "39485561"
  },
  {
      "name": "Unwelcome School",
      "artist": "yoko",
      "hash": "c24f07c8f14d92e6fd99a1bc6adf2589",
      "album_id": "69374996"
  },
  {
      "name": "uzumakinoharu",
      "artist": "sasakure.UK",
      "hash": "ed19ec9bdbb44e2c8d26f7de8fe283aa",
      "album_id": "939751"
  },
  {
      "name": "Wellerman (Sea Shanty)",
      "artist": "Nathan Evans",
      "hash": "8a79c0a2dc93b3606a1d0260cdaec2fa",
      "album_id": "41196423"
  },
  {
      "name": "ひやむぎ、そーめん、時々うどん",
      "artist": "みかん箱",
      "hash": "fd03c1c9e8dc7828591b9398f4aeef16",
      "album_id": "580860"
  },
  {
    "type":"netease",
    "id":"38019092",
    "name":"Lifeline",
    "artist":"Zeraphym 六翼使徒",
    album:"生命线"
  },
  {
    "type":"netease",
    "id":"479480785",
    "name":"Dawnbreath（α）",
    "artist":"Aginomoto / warma",
    album:"Dawnbreath 【ED曲】"
  },
  {
    "type":"netease",
    "id":"479483121",
    "name":"Dawnbreath（β）",
    "artist":"Aginomoto / warma",
    album:"Dawnbreath 【ED曲】"
  },
  {
    "type":"netease",
    "id":"1409555991",
    "name":"Warma Is Good",
    "artist":"warma / 湯ん",
    album:"Warma Is Good"
  },
  {
    "type":"netease",
    "id":"22676167",
    "name":"Flower Dance",
    "artist":"DJ Okawari",
    album:"Kaleidoscope"
  },
  {
    "name": "Warma! Yeah!",
    "artist": "Warma、Crazy Bucket 陈楒潼",
    "hash": "adfcf9573cece58918ad4bb9e4aa8424",
    "album_id": "15104683"
},
{
  "name": "Fragments",
  "artist": "千坂",
  "hash": "271b37e61a613cb5370fb993f29e762f",
  "album_id": "40992304"
},
{
    "name": "甜蜜魔法",
    "artist": "warma",
    "hash": "a8a93be0105c2914e7357d8e45596cb1",
    "album_id": "32929472"
},
{
  "name": "Step by Step",
  "artist": "KARUT",
  "hash": "963a80cbd230f6e549882b23c84a4a84",
  "album_id": "60117919"
},
{
  "name": "Shed a Light",
  "artist": "9liur",
  "hash": "dcf08ca10355da7cddd26ccca8a8e998",
  "album_id": "75482312"
},
{
  "name": "Remember Me",
  "artist": "Anthem Lights",
  "hash": "07f9826ce2fb6af40cb49156156837ac",
  "album_id": "75046002"
},
{
  "name": "月下花轻舞",
  "artist": "傅许",
  "hash": "4f1a7cf794a27110ac8032ecf436095a",
  "album_id": "8492070"
},
{
  "name": "别让我担心",
  "artist": "多多poi",
  "hash": "38c0f84dd7a22e17f67decc9949cb8d0",
  "album_id": "78828770"
}
]

var nowsong=0;
var audio=document.querySelector("#audio");
var LRC=null;
var getter=null;
var playbtn=document.querySelector(".playbtn");
var range=document.querySelector("input[type=range]");

function play(id){
  nowsong=id;
  var aq=document.querySelector(".playlist li.act");
  if(aq){
    aq.classList.remove('act');
  }
  document.querySelectorAll('.playlist li')[id].classList.add('act');
  if(getter){
    getter.abort();
    getter=null;
  } 
  ref();
  if(songlist[id].type=='netease'){
    initPlayer('netease',songlist[id].id,songlist[id].album);
  }else if(songlist[id].type=='url'){
    initPlayer('url',songlist[id].title,songlist[id].artist,songlist[id].album,songlist[id].img,songlist[id].url,songlist[id].lrc??'');
  }else{
    initPlayer('kugou',songlist[id].hash,songlist[id].album_id);
  }
}

function initPlayer(k,m,n,o,p,q,r){
  if(k=='netease'){
    getter=get('https://api.gumengya.com/Api/Netease?format=json&id='+m,function(res){
      getter=null;
      if(res.code==200){
        var song=res.data;
        document.querySelector("#album_img").src= document.querySelector("#bg_img").src=song.pic;
        document.querySelector("#album_name").innerText=n;
        document.querySelector("#singer").innerText=song.author;
        document.querySelector("#title").innerText=song.title;
        audio.src=song.url;
        LRC=kugou.parseLrc(song.lrc);
      }else{
        alert('歌曲获取出错！');
        document.querySelector(".next").click();
      }
    },function(){
      getter=null;
      alert('歌曲获取出错！');
      document.querySelector(".next").click();
    })
  }else if(k=='url'){
    document.querySelector("#album_img").src= document.querySelector("#bg_img").src=p;
    document.querySelector("#album_name").innerText=o;
    document.querySelector("#singer").innerText=n;
    document.querySelector("#title").innerText=m;
    audio.src=q;
    LRC=kugou.parseLrc(r);
  }else{
    getter=kugou.getSongDetails(m,n,function(song){
      getter=null;
      if(song.error){
        alert('歌曲获取出错！');
        document.querySelector(".next").click();
        return;
      }
      // 修复https加载http的问题
      document.querySelector("#album_img").src= document.querySelector("#bg_img").src=song.img.replace('http://','https://');
      document.querySelector("#album_name").innerText=song.album;
      document.querySelector("#singer").innerText=song.artist;
      document.querySelector("#title").innerText=song.songname
      if(song.ispriviage){
        document.querySelector("#title").innerHTML+='<span class="vip">VIP</span>';
      }
      audio.src=song.url;
      LRC=song.lrc;
    })
  }
}


function get(url,cb,err){
  var xhr=new XMLHttpRequest();
  xhr.open('GET',url);
  xhr.onreadystatechange=function(){
    if(xhr.readyState==4&&xhr.status==200){
      cb(JSON.parse(xhr.responseText));
    }
  }
  xhr.onerror=err;
  xhr.send();
  return {
    abort:function(){
      xhr.abort();
    }
  }
}

function ref(){
  document.querySelector("#album_img").src= document.querySelector("#bg_img").src='';
  document.querySelector("#album_img").style.opacity= document.querySelector("#bg_img").style.opacity='';
  document.querySelector("#album_name").innerHTML='--';
  document.querySelector("#singer").innerHTML='--';
  document.querySelector("#title").innerHTML='获取中...';
}
document.querySelector("#album_img").onload=document.querySelector("#bg_img").onload=function(){
  this.style.opacity='1';
}

audio.oncanplay=function(){
  try{audio.play();}catch(e){
    console.log('Auto-Play is prevent.')
  }
}
audio.onplay=function(){
  playbtn.className='bi bi-pause playbtn';
  document.querySelector(".player").classList.add('play')
}
audio.onpause=function(){
  playbtn.className='bi bi-play-fill playbtn';
  document.querySelector(".player").classList.remove('play')
}
audio.ontimeupdate=function(){
  document.querySelector(".time").innerHTML=getFormatTime(audio.currentTime) + '/' + getFormatTime(audio.duration);
  range.max=audio.duration;
  if(!window.___) range.value=audio.currentTime;
  var s='';
  for (var k in LRC) {
    if (parseFloat(k) > audio.currentTime) {
      document.querySelector(".lrc").innerHTML=s;
      s=-1;
      break;
    }
    s=LRC[k];
  }
  if(s!=-1){
    document.querySelector(".lrc").innerHTML=s;
  }
}
audio.onended=function(){
  var isLoop=document.querySelector(".item.isrepeat").classList.contains('act');
  if(isLoop){
    audio.currentTime=0;
    audio.play();
  }else{
    document.querySelector(".next").click();
  }
}
function getFormatTime(s) {
  var m = Math.floor(s / 60);
  if (m < 10) m = '0' + m;
  var s2 = parseInt(s % 60);
  if (s2 < 10) s2 = '0' + s2;
  return m + ':' + s2;
}

playbtn.onclick=function(){
  if(audio.paused){
    audio.play();
  }else{
    audio.pause();
  }
}
range.onchange=function(){
  audio.currentTime=range.value;
}
range.onmousedown=function(){
  window.___=true;
  document.onmouseup=function(){
    window.___=false;
    document.onmouseup=null;
  }
}

// touch
range.addEventListener('touchstart',function(){
  window.___=true;
  document.addEventListener('touchend',function(){
    window.___=false;
    document.ontouchend=null;
  },{
    passive:false
  });
},{
  passive:false
})
document.querySelector(".last").onclick=function(){
  if(nowsong==-1){
    rplay();
    return;
  } 
  play(nowsong-1<0?songlist.length-1:nowsong-1);
}
document.querySelector(".next").onclick=function(){
  if(nowsong==-1){
    rplay();
    return;
  } 
  play(nowsong+1>songlist.length-1?0:nowsong+1);
}

function rplay(){
  play(Math.floor(Math.random()*songlist.length));
}
var pl=document.querySelector(".playlist ul");
songlist.forEach(function(r,i){
  var li=document.createElement('li');
  li.innerHTML=i+' '+r.name+' - '+r.artist;
  li.onclick=function(){
    play(i);
  }
  pl.append(li);
})


document.querySelector(".item.playlistbtn").onclick=function(e){
  e.stopPropagation();
  document.querySelector(".playlist").style.display='block';
  var actLi=document.querySelector(".playlist li.act");
  actLi&&actLi.scrollIntoView({
    block:"center"
  });
}
document.querySelector(".item.randombtn").onclick=rplay;
document.querySelector(".item.isrepeat").onclick=function(){
  if(this.classList.contains('act')){
    this.classList.remove('act');
  }else{
    this.classList.add('act');
  }
}

document.onclick=function(){
  document.querySelector(".playlist").style.display='';
};

/*
?type=index&i=<歌曲歌单索引> 播放歌单内歌曲
?type=kugou&hash=<hash>&album_id=<album_id> 从酷狗音乐获取歌曲播放
?type=netease&id=<id> 从网易云音乐获取歌曲播放

当type!=index时，会判断歌曲是否存在歌单中
 */
(function(){
  var us=new URL(location.href).searchParams;
  if(us.get('type')=='index'){
    var i=parseInt(us.get('i'));
    i&&!isNaN(i)&&i>=0&&i<songlist.length?play(i):rplay();
  }else if(us.get('type')=='kugou'){
    var h=us.get('hash');
    var a=us.get('album_id');
    if(!h||!a){
      rplay();
      return;
    }
    for(var i=0;i<songlist.length;i++){
      if(songlist[i].hash==h){
        play(i);
        return;
      }
    }
    nowsong=-1;
    initPlayer('kugou',h,a);
  }else if(us.get('type')=='netease'){
    var id=us.get('id');
    if(!id){
      rplay();
      return;
    }
    for(var i=0;i<songlist.length;i++){
      if(songlist[i].id==id){
        play(i);
        return;
      }
    }
    nowsong=-1;
    initPlayer('netease',id,'');
  }else if(us.get('type')=='url'){
    var url=us.get('url');
    var title=us.get('title');
    var artist=us.get('artist');
    var album=us.get('album');
    var img=us.get('img');
    if(!url){
      rplay();
      return;
    }
    initPlayer('url',title,artist,album,img,url);
  }else{
    rplay();
  }
})()
